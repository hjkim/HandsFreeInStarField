<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.sinc.admin">

	<select id="list" resultType="adminVO">
		SELECT  ODR_ID,
				PICKUP_ID,
				CUSTOMER_ID,
				ODR_DATE,
				ODR_STATE,
				TOTAL_PRICE
		FROM 	ORDER_REQUEST
		ORDER BY ODR_DATE DESC
	</select>
	<select id="weekDaypickuptime" resultType="sincMap">
	
	</select>
	<select id="pickuptime" resultType="sincMap">
 
 SELECT 
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________10%') AS T10,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________11%') AS T11,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________12%') AS T12,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________13%') AS T13,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________14%') AS T14,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________15%') AS T15,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________16%') AS T16,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________17%') AS T17,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________18%') AS T18,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________19%') AS T19,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________20%') AS T20,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________21%') AS T21,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________22%') AS T22,
  (SELECT COUNT(*) FROM ORDER_REQUEST
  WHERE TO_CHAR(PICKUP_DATE,'YYYYMMDDHH24MISS') LIKE '________23%') AS T23
 FROM DUAL

 </select>
 
 <select id="pickupterm" resultType="sincMap">
  <![CDATA[  SELECT 
   COUNT(CASE WHEN TB_GAP.GAP <=60 THEN TB_GAP.GAP ELSE NULL END) AS "hour1",
   COUNT(CASE WHEN TB_GAP.GAP > 60 AND TB_GAP.GAP <=120 THEN TB_GAP.GAP ELSE NULL END) AS "hour2",
   COUNT(CASE WHEN TB_GAP.GAP > 120 AND TB_GAP.GAP <=180 THEN TB_GAP.GAP ELSE NULL END) AS "hour3",
   COUNT(CASE WHEN TB_GAP.GAP > 180 AND TB_GAP.GAP <=240 THEN TB_GAP.GAP ELSE NULL END) AS "hour4",
   COUNT(CASE WHEN TB_GAP.GAP > 240 AND TB_GAP.GAP <=300 THEN TB_GAP.GAP ELSE NULL END) AS "hour5",
   COUNT(CASE WHEN TB_GAP.GAP > 300 AND TB_GAP.GAP <=360 THEN TB_GAP.GAP ELSE NULL END) AS "hour6",
   COUNT(CASE WHEN TB_GAP.GAP > 360 AND TB_GAP.GAP <=420 THEN TB_GAP.GAP ELSE NULL END) AS "hour7",
   COUNT(CASE WHEN TB_GAP.GAP > 420 AND TB_GAP.GAP <=480 THEN TB_GAP.GAP ELSE NULL END) AS "hour8",
   COUNT(CASE WHEN TB_GAP.GAP > 480 AND TB_GAP.GAP <=540 THEN TB_GAP.GAP ELSE NULL END) AS "hour9",
   COUNT(CASE WHEN TB_GAP.GAP >540 THEN TB_GAP.GAP ELSE NULL END) AS "hour10"
  FROM
   ((SELECT ((TRUNC(PICKUP_DATE,'MI') - TRUNC(ODR_DATE,'MI'))*24*60) AS GAP
   FROM ORDER_REQUEST) TB_GAP)]]>
 </select>
	
	<select id="weekDayOrder" resultType="sincMap">
		SELECT
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________10%'
			AND TO_CHAR(ODR_DATE,'d') IN ('2','3','4','5','6')) AS H10,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________11%'
			AND TO_CHAR(ODR_DATE,'d') IN ('2','3','4','5','6')) AS H11,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________12%'
			AND TO_CHAR(ODR_DATE,'d') IN ('2','3','4','5','6')) AS H12,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________13%'
			AND TO_CHAR(ODR_DATE,'d') IN ('2','3','4','5','6')) AS H13,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________14%'
			AND TO_CHAR(ODR_DATE,'d') IN ('2','3','4','5','6')) AS H14,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________15%'
			AND TO_CHAR(ODR_DATE,'d') IN ('2','3','4','5','6')) AS H15,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________16%'
			AND TO_CHAR(ODR_DATE,'d') IN ('2','3','4','5','6')) AS H16,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________17%'
			AND TO_CHAR(ODR_DATE,'d') IN ('2','3','4','5','6')) AS H17
		FROM DUAL
	</select>
	
	<select id="weekendDayOrder" resultType="sincMap">
		SELECT
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________10%'
			AND TO_CHAR(ODR_DATE,'d') IN ('1','7')) AS H10,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________11%'
			AND TO_CHAR(ODR_DATE,'d') IN ('1','7')) AS H11,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________12%'
			AND TO_CHAR(ODR_DATE,'d') IN ('1','7')) AS H12,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________13%'
			AND TO_CHAR(ODR_DATE,'d') IN ('1','7')) AS H13,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________14%'
			AND TO_CHAR(ODR_DATE,'d') IN ('1','7')) AS H14,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________15%'
			AND TO_CHAR(ODR_DATE,'d') IN ('1','7')) AS H15,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________16%'
			AND TO_CHAR(ODR_DATE,'d') IN ('1','7')) AS H16,
			(SELECT COUNT(*) FROM ORDER_REQUEST 
			        WHERE  TO_CHAR(ODR_DATE,'YYYYMMDDHH24MISS') LIKE '________17%'
			AND TO_CHAR(ODR_DATE,'d') IN ('1','7')) AS H17
		FROM DUAL
	</select>
	
	<select id="WeekDaypackDueTime" resultType="sincMap">
	<![CDATA[
		SELECT 
			COUNT(CASE WHEN TB_GAP.GAP <=60 THEN TB_GAP.GAP ELSE NULL END) AS "h1",
			COUNT(CASE WHEN TB_GAP.GAP > 60 AND TB_GAP.GAP <=120 THEN TB_GAP.GAP ELSE NULL END) AS "h2",
			COUNT(CASE WHEN TB_GAP.GAP > 120 AND TB_GAP.GAP <=180 THEN TB_GAP.GAP ELSE NULL END) AS "h3",
			COUNT(CASE WHEN TB_GAP.GAP > 180 AND TB_GAP.GAP <=240 THEN TB_GAP.GAP ELSE NULL END) AS "h4",
			COUNT(CASE WHEN TB_GAP.GAP > 240 AND TB_GAP.GAP <=300 THEN TB_GAP.GAP ELSE NULL END) AS "h5",
			COUNT(CASE WHEN TB_GAP.GAP > 300 AND TB_GAP.GAP <=360 THEN TB_GAP.GAP ELSE NULL END) AS "h6"
			FROM
			((SELECT ((TRUNC(PACK_DATE,'MI') - TRUNC(ODR_DATE,'MI'))*24*60) AS GAP
		FROM ORDER_REQUEST WHERE TO_CHAR(ODR_DATE,'d') IN ('2','3','4','5','6')) TB_GAP)
		]]>
	</select>
	
	<select id="WeekEndDaypackDueTime" resultType="sincMap">
	<![CDATA[
		SELECT 
			COUNT(CASE WHEN TB_GAP.GAP <=60 THEN TB_GAP.GAP ELSE NULL END) AS "h1",
			COUNT(CASE WHEN TB_GAP.GAP > 60 AND TB_GAP.GAP <=120 THEN TB_GAP.GAP ELSE NULL END) AS "h2",
			COUNT(CASE WHEN TB_GAP.GAP > 120 AND TB_GAP.GAP <=180 THEN TB_GAP.GAP ELSE NULL END) AS "h3",
			COUNT(CASE WHEN TB_GAP.GAP > 180 AND TB_GAP.GAP <=240 THEN TB_GAP.GAP ELSE NULL END) AS "h4",
			COUNT(CASE WHEN TB_GAP.GAP > 240 AND TB_GAP.GAP <=300 THEN TB_GAP.GAP ELSE NULL END) AS "h5",
			COUNT(CASE WHEN TB_GAP.GAP > 300 AND TB_GAP.GAP <=360 THEN TB_GAP.GAP ELSE NULL END) AS "h6"
			FROM
			((SELECT ((TRUNC(PACK_DATE,'MI') - TRUNC(ODR_DATE,'MI'))*24*60) AS GAP
		FROM ORDER_REQUEST WHERE TO_CHAR(ODR_DATE,'d') IN ('1','7')) TB_GAP)
		]]>
	</select>
</mapper>  